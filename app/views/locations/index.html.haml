- javascript 'gmaps4rails.js'
%h1 Listing locations
%p
  = gmaps4rails map_data(@locations)
%table.table
  - clusters = @map_points.keys.sort { |a,b| a.sequence <=> b.sequence }
  - clusters.each do |cluster|
    - locations = @map_points[cluster]
    %tr
      %th{colspan: 3}
        %h3
          = link_to cluster.name, cluster
          = marker_img cluster.color, ''
          = " - #{locations.count} locations"
    %tr
      %th Name
      %th Address
      %th Destination for...
    - locations.each_pair do |letter, location|
      %tr
        %td
          = marker_img cluster.color, letter
          = link_to location.name, location
        %td= location.address
        %td
          - location.puzzles.each do |puzzle|
            = link_to puzzle.name, puzzle
%br/
= link_to 'New Location', new_location_path
